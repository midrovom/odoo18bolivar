<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <!-- Registro del snippet -->
  <template id="s_gallery_snippet" inherit_id="theme_prime.snippets" name="Products Gallery - 6 Registry">
    <xpath expr="//t[@t-snippet='theme_prime.s_gallery_5']" position="after">
      <t t-snippet="theme_prime_image._products_gallery_editable"
         string="Products Gallery - 6"
         group="theme_prime_gallery"
         t-thumbnail="/theme_prime_image/static/src/img/s_banner_custom/thumb_banner.png">
        <keywords>gallery, album, portfolio</keywords>
      </t>
    </xpath>
  </template>

<template id="s_products_gallery_editable" name="Products Gallery Editable">
  <section class="s_products_gallery o_snippet py-4"
           data-category-id="0"
           data-oe-model="product.public.category"
           data-oe-field="id"
           data-oe-many2one="1">
    <div class="container">
      <div class="row row-cols-2 row-cols-md-5 g-3">

        <!-- Obtener categoría desde atributo -->
        <t t-set="category_id" t-value="int(attrs.get('data-category-id') or 0)"/>

        <!-- Selección de productos -->
        <t t-if="category_id">
          <t t-set="products" t-value="env['product.template'].sudo().search([('public_categ_ids','in',[category_id])], limit=10)"/>
        </t>
        <t t-else="">
          <t t-set="products" t-value="env['product.template'].sudo().search([], limit=10)"/>
        </t>

        <!-- Iterar productos -->
        <t t-foreach="products" t-as="product">
          <div class="col">
            <div class="product-card text-center p-3 h-100">
              <img t-att-src="'/web/image/product.template/%s/image_1920' % product.id"
                   t-att-alt="product.name"
                   class="img-fluid mb-2"/>
              <hr class="my-2"/>
              <h5 class="fw-bold text-truncate" t-att-title="product.name">
                <t t-esc="product.name"/>
              </h5>
              <ul class="list-unstyled small text-muted text-start text-wrap">
                <t t-foreach="product.attribute_line_ids" t-as="attr">
                  <t t-if="attr.attribute_id.name != 'Marca'">
                    <t t-foreach="attr.value_ids" t-as="val">
                      <li class="d-flex align-items-center mb-1 text-truncate">
                        <span><t t-esc="val.name"/></span>
                      </li>
                    </t>
                  </t>
                </t>
              </ul>
            </div>
          </div>
        </t>
      </div>
    </div>
  </section>
</template>
</odoo>
