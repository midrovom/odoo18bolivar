<?xml version="1.0" encoding="utf-8"?>
<odoo>
<template id="template_header_style_4_inherit" inherit_id="theme_prime.template_header_style_4" name="Header Style - 4 Inherit">
    <xpath expr="//div[contains(@class,'tp-account-info')]//div[contains(@class,'col-auto')][.//i[contains(@class,'dri-user')]]"
           position="replace">
        <div class="col-auto my-1">
            <div class="d-flex align-items-center">
                <div class="flex-grow-1 d-none d-xl-block">
                    <!-- Si es público: Register | Login -->
                    <div class="d-flex align-items-center" t-if="user_id._is_public()">
                        <a class="tp-account-info-sidebar-action me-2" href="/web/signup">Register</a>
                        <span class="mx-1">|</span>
                        <a class="tp-account-info-sidebar-action ms-2" href="/web/login">Login</a>
                    </div>

                    <!-- Si está logueado: Nombre del usuario + caret ▼ -->
                    <div t-if="not user_id._is_public()" class="d-flex align-items-center">
                        <span class="me-2 text-truncate" style="max-width: 150px;">
                            <t t-out="user_id.name"/>
                        </span>
                        <a class="tp-account-info-sidebar-action" href="/my/home">
                            <i class="fa fa-caret-down"></i>
                        </a>
                    </div>
                </div>

                <!-- Carrito incrustado -->
                <div class="flex-shrink-0 ms-3">
                    <t t-nocache="The number of products is dynamic, this rendering cannot be cached.">
                        <t t-set="website_sale_cart_quantity"
                           t-value="request.session['website_sale_cart_quantity'] if 'website_sale_cart_quantity' in request.session else website.sale_get_order().cart_quantity or 0"/>
                        <t t-set="show_cart" t-value="website.has_ecommerce_access()"/>
                        <div t-attf-class="o_not_editable position-relative o_wsale_my_cart tp-cart-sidebar-action #{not show_cart and 'd-none'}">
                            <a href="/shop/cart">
                                <i class="dri dri-cart tp-light-bg rounded-circle"/>
                                <sup class="my_cart_quantity badge bg-primary"
                                     t-out="website_sale_cart_quantity"
                                     t-att-data-order-id="request.session.get('sale_order_id', '')"/>
                            </a>
                        </div>
                    </t>
                </div>

            </div>
        </div>
    </xpath>

    <!-- Elimina el bloque de wishlist -->
    <xpath expr="//div[contains(@class,'tp-account-info')]//div[contains(@class,'col-auto')][.//i[contains(@class,'dri-wishlist')]]"
           position="replace"/>

    <!-- Elimina el bloque original del carrito -->
    <xpath expr="//div[contains(@class,'tp-account-info')]//div[contains(@class,'col-auto')][.//i[contains(@class,'dri-cart')]]"
           position="replace"/>

    <!-- Personalización de barra de busqueda en este estilo -->
    <xpath expr="//t[@t-call='website.website_search_box_input']" position="replace">
        <t t-call="website.website_search_box_input">
            <t t-set="_placeholder" t-value="'Encuentra todo lo que necesitas'"/>
            <t t-set="_form_classes" t-valuef="mx-auto o_wsale_products_searchbar_form o_not_editable searchbar-small"/>
            <t t-set="_classes" t-valuef="border tp-input-border-radius"/>
            <t t-set="search_type" t-valuef="products"/>
            <t t-set="action" t-value="'/shop'"/>
        </t>
    </xpath>

</template>
</odoo>
